---
layout: post
title: "DFT Convolution"
date: 2024-12-09 16:49:50 +0900
categories: 
tags: 
---

# **DFT 기반 Convolution**

**DFT 기반 Convolution**은 이미지에서 특정 패턴을 **강조하거나 억제**하는 데 사용됩니다. 결과적으로 **필터에 따라 이미지에서 원하는 패턴을 추출**할 수 있습니다.

---

### DFT Convolution과 패턴 추출의 관계:
1. **필터의 역할**:
   - 필터는 **주파수 영역에서 특정 대역(패턴)**을 선택하거나 제거하는 역할을 합니다.
   - 예를 들어:
     - **Low-pass filter**: 저주파를 통과시키고 고주파(노이즈나 경계)를 제거 → 이미지가 부드럽게 변함.
     - **High-pass filter**: 고주파를 통과시키고 저주파를 억제 → 경계나 텍스처 강조.
     - **Band-pass filter**: 특정 주파수 대역만 통과 → 특정 패턴만 강조.

2. **DFT 기반 Convolution의 핵심**:
   - 주파수 영역에서 이미지와 필터를 곱하면, 필터가 정의한 주파수 대역에 해당하는 정보만 남게 됩니다.
   - 역푸리에 변환(IFT)을 통해 이 정보를 다시 공간 영역으로 변환하면, 필터링된 패턴이 결과 이미지로 나타납니다.

3. **패턴 추출**의 결과:
   - 이미지의 **특정 주파수 대역(패턴, 텍스처)**만 남기거나, 필요 없는 대역을 제거합니다.
   - 주파수 필터링을 통해 추출한 패턴은 원본 이미지의 특정 구조적 특징을 강조합니다.

---

### DFT Convolution은 **"패턴을 만든다"** 라는 관점에서 이해하기:
#### 패턴 생성의 과정:
- **원본 이미지**: 주파수 공간에서 다양한 주파수 성분으로 이루어져 있음.
- **필터링**: 필터가 특정 주파수를 선택(강조)하거나 제거(억제)함.
- **결과 이미지**: 필터가 통과시킨 주파수 대역에 해당하는 패턴만 남게 됨.

---

Figure 1은 **노이즈 상태의 원본 이미지**이고, Figure 2는 해당 이미지에 **DFT 기반 Convolution**을 적용한 결과를 나타냅니다. 이를 통해, 주파수 영역에서 필터링 작업이 수행되었음을 보여줍니다.

---

### 주요 작업 요약:


<img src="/post_img/1209/image.png" width="500px">

1. **원본 이미지 (Figure 1)**:
   - rand(256, 256)으로 생성된 랜덤 노이즈 이미지입니다.
   - 이는 단순히 예제용으로 생성한 데이터이며, 실제로는 원본 이미지 대신 카메라 데이터나 다른 형태의 이미지가 사용될 수 있습니다.

2. **DFT 기반 Convolution 적용 (Figure 2)**:
   - Figure 2는 원본 노이즈 이미지에 필터링 작업이 수행된 결과입니다.
   - 이 작업은 주파수 영역에서 이루어졌습니다:
     1. 원본 이미지를 **DFT(이산 푸리에 변환)** 하여 주파수 영역으로 변환.
     2. 필터를 동일한 크기로 제로 패딩한 후 주파수 영역으로 변환.
     3. 두 주파수 영역 데이터를 곱함 (주파수 영역에서 합성곱은 곱셈으로 표현됨).
     4. 최종적으로 **역푸리에 변환(IFFT)** 하여 공간 영역으로 결과를 복원.

3. **결과 (Figure 2)**:
   - 주파수 기반 필터링이 적용되어 노이즈 이미지가 변형된 상태.
   - 필터가 어떤 역할을 했는지에 따라 이미지가 흐려지거나(블러링), 특정 패턴이 강조될 수 있습니다.

---

### DFT 기반 Convolution의 의미:
- **공간 영역 필터링 대신 주파수 영역 필터링을 사용**한 것입니다.
- Figure 2는 필터(S)가 노이즈 이미지에 적용된 결과입니다.
- 필터가 어떤 특성을 갖는지에 따라, 노이즈를 억제하거나 특정 주파수 대역을 강조하는 결과를 얻을 수 있습니다.

---

### 이 작업의 목적:
- Figure 1의 원본 노이즈 데이터는 아무런 필터링이 없는 상태입니다.
- Figure 2에서는 필터를 통해 특정 주파수 대역을 강조하거나 억제하여 노이즈를 제거하거나 원하는 패턴을 추출하는 데 활용됩니다.
- 이는 이미지 처리에서 다음과 같은 작업에 응용됩니다:
  - 노이즈 제거 (Low-pass filter).
  - 경계 강조 (High-pass filter).
  - 주파수 대역 제한 등.
